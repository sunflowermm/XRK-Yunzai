# XRK-Yunzai服务器配置
name: XRK-Yunzai Server  # 服务器名称
url:                     # 自定义外部URL（可选）
host: 0.0.0.0           # 监听地址
port: 2537              # 监听端口

# HTTPS配置
https:
  enabled: false
  key: ./config/certs/privkey.pem
  cert: ./config/certs/fullchain.pem

# 静态文件服务配置
static:
  - route: /www           # 路由路径
    path: www            # 文件系统路径
    options:
      index: true        # 是否启用默认文档
      dotfiles: deny     # 处理隐藏文件：ignore/allow/deny
      extensions:        # 默认文件扩展名
        - html
        - htm
      fallthrough: true  # 404时是否继续到下一个中间件
      maxAge: 1d         # 缓存时间
      browse: false      # 是否启用目录浏览
      headers:           # 自定义响应头
        X-Custom-Header: value

  - route: /public
    path: public
    options:
      index: true
      maxAge: 7d

  - route: /media
    path: www/media
    options:
      maxAge: 30d
      browse: true

# 认证配置
auth:
  whitelist:            # 免认证路径
    - /www
    - /public
    - /static
    - /favicon.ico
    - /health
  skip:                 # 跳过认证的路径（兼容旧版）
    - /www
    - /media
    - /api/files

# CORS配置
cors:
  origins:              # 允许的源
    - "*"              # 或具体域名列表
  methods: GET, POST, PUT, DELETE, OPTIONS
  headers: Origin, X-Requested-With, Content-Type, Accept, X-API-Key, Authorization
  credentials: false    # 是否允许携带凭证

# 安全配置
security:
  helmet: true          # 启用Helmet安全头
  csp: false           # 内容安全策略（false表示禁用）
  hiddenFiles:         # 隐藏文件规则（正则或字符串）
    - /^\./
    - /\/\./
    - node_modules
    - .git
    - .env
    - /config\//
    - /private/

# 速率限制
rateLimit:
  enabled: true
  api:
    windowMs: 900000    # 15分钟
    max: 100           # 最大请求数
    message: Too many requests from this IP

# 请求体大小限制
limits:
  json: 10mb
  urlencoded: 10mb
  raw: 10mb
  text: 10mb

# 日志配置
logging:
  requests: true        # 记录HTTP请求

# 性能优化
compression: true       # 启用gzip压缩
detectPublicIP: true   # 检测外网IP

# 默认路由
defaultRoute: /www/xrk     # 404时的默认重定向路径